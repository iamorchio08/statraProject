// Generated by CoffeeScript 1.9.2
(function() {
  module.exports = function(memo) {
    var collection, collectionLink, createDocument;
    if ((memo != null ? memo.documents : void 0) == null) {
      throw new Error('generateData must be called with an object containing a `documents` field.');
    }
    if (memo.totalCount == null) {
      memo.totalCount = 0;
    }
    memo.countForThisRun = 0;
    collection = getContext().getCollection();
    collectionLink = collection.getSelfLink();
    memo.stillQueueing = true;
    createDocument = function() {
      var row;
      if (memo.documents.length > 0 && memo.stillQueueing) {
        row = memo.documents.pop();
        getContext().getResponse().setBody(memo);
        return memo.stillQueueing = collection.createDocument(collectionLink, row, function(error, resource, options) {
          if (error != null) {
            throw new Error(error);
          } else if (memo.stillQueueing) {
            memo.countForThisRun++;
            memo.totalCount++;
            return createDocument();
          } else {
            memo.documents.push(row);
            memo.continuation = "value does not matter";
            return getContext().getResponse().setBody(memo);
          }
        });
      } else {
        memo.continuation = null;
        return getContext().getResponse().setBody(memo);
      }
    };
    return createDocument();
  };

}).call(this);
